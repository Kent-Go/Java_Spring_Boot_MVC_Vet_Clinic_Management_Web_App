<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Confirm Appointment</title>
    <link rel="stylesheet" href="/css/confirmAppointment.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const appointmentTypeName = document.querySelector('.appointment-type-name');
            const selectedAppointmentTypeId = localStorage.getItem('selectedAppointmentTypeId');
            
            // fetch appointment type details using id
            fetch(`/api/appointment_type/${selectedAppointmentTypeId}`)
                .then((response) => response.json())
                .then((data) => {
                    appointmentTypeName.textContent = data.name;
                })
                .catch((error) => {
                    console.error('Error fetching appointment type:', error);
                });
            
            const petInfo = document.querySelector('.pet-info');
            const selectedPetId = localStorage.getItem('selectedPetId');
            
            // fetch pet details using id
            fetch(`/api/pet/${selectedPetId}`)
                .then((response) => response.json())
                .then((data) => {
                    petInfo.textContent = data.name + ' (' + data.gender + ' ' + data.breed + ')';
                })
                .catch((error) => {
                    console.error('Error fetching pet:', error);
                });

            document.querySelector('.back-button').addEventListener('click', function () {
                window.history.back();
            });
    
            document.querySelector('.confirm-button').addEventListener('click', function () {
                // Simulate confirmation of the appointment
                alert('Appointment confirmed!');
                // Redirect to a confirmation or home page
                window.location.href = '/home';
            });
        });
    </script>
</head>
<body>

<div class="header">
    <a href="/">
        <img src="/images/logo.png" alt="Logo" class="logo">
    </a>
    <a href="login" class="profile-link">
        <img src="/images/profile.png" alt="Profile" class="profile-icon">
    </a>
</div>

<div class="container">
    <h1>New Appointment Scheduling</h1>
    <h3>Confirm your Appointment:</h3>

    <div class="appointment-summary">
        <p><strong>Appointment Type:</strong> <span class="appointment-type-name"></span></p>
        <p><strong>Pet:</strong> <span class="pet-info"></span></p>
        <p><strong>Date:</strong> <span class="appointment-date"></span></p>
        <p><strong>Time:</strong> <span th:text="${time}">11:00 AM</span></p>
        <p><strong>Veterinarian:</strong> <span th:text="${vetName}">Dr Jude Bellingham</span></p>
    </div>

    <div class="buttons">
        <button type="button" class="back-button">Back</button>
        <button type="button" class="confirm-button">Confirm</button>
    </div>
</div>

</body>
</html>
