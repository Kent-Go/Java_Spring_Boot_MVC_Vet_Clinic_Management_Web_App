<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Prescription</title>
    <link rel="stylesheet" href="/css/managePrescription.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Add new prescription dynamically
            document.getElementById('add-prescription').addEventListener('click', function (event) {
                event.preventDefault();

                // Get input values from the form
                const medicineName = document.getElementById('medicine').selectedOptions[0].text;
                const dosage = document.getElementById('dosage').value;
                const dailyFrequency = document.getElementById('dailyFrequency').value;
                const duration = document.getElementById('duration').value;
                const instruction = document.getElementById('instruction').value;

                // Validate input fields
                if (!dosage || !dailyFrequency || !duration || !instruction) {
                    alert("Please fill out all fields");
                    return;
                }

                // Create a new div for the prescription
                const newPrescription = document.createElement('div');
                newPrescription.classList.add('existing-prescription');

                // Append prescription details to the new div
                newPrescription.innerHTML = `
                    <h3>Medicine Name: <span>${medicineName}</span></h3>
                    <p>Dosage: <span>${dosage}</span> Tablet x <span>${dailyFrequency}</span> Daily</p>
                    <p>Duration: <span>${duration}</span> Days</p>
                    <p>Instruction: <span>${instruction}</span></p>
                `;

                // Append the new prescription to the prescription list
                document.getElementById('prescription-list').appendChild(newPrescription);

                // Clear the input fields after adding the prescription
                document.getElementById('dosage').value = '';
                document.getElementById('dailyFrequency').value = '';
                document.getElementById('duration').value = '';
                document.getElementById('instruction').value = '';
            });
        });
    </script>
</head>
<body>
<div class="header">
    <a href="/">
        <img src="/images/logo.png" alt="Logo" class="logo" />
    </a>
    <a href="#" class="profile-link">
        <img src="/images/profile.png" alt="Profile" class="profile-icon" />
    </a>
</div>

<div class="container">
    <h1>Manage Prescription</h1>

    <!-- Existing Prescriptions -->
    <div id="prescription-list">
        <div th:each="prescription : ${prescriptions}" class="existing-prescription">
            <h3>Medicine Name:
                <span th:text="${prescription.medicine != null ? prescription.medicine.name : 'No Medicine'}">Frusemide 20mg</span>
            </h3>
            <p>Dosage: <span th:text="${prescription.dosage}">1</span> Tablet x <span th:text="${prescription.dailyFrequency}">2</span> Daily</p>
            <p>Duration: <span th:text="${prescription.duration}">14</span> Days</p>
            <p>Instruction: <span th:text="${prescription.instruction}">Feed during breakfast and dinner</span></p>
        </div>
    </div>

    <!-- Add a new prescription form -->
    <form>
        <h3>Add New Prescription</h3>
        <label for="medicine">Medicine Name:</label>
        <select id="medicine">
            <option th:each="medicine : ${medicines}" th:value="${medicine.id}" th:text="${medicine.name}">Frusemide</option>
        </select>

        <label for="dosage">Dosage:</label>
        <input type="text" id="dosage" placeholder="Dosage" required />

        <label for="dailyFrequency">Daily Frequency:</label>
        <input type="number" id="dailyFrequency" placeholder="Times per day" required />

        <label for="duration">Duration:</label>
        <input type="number" id="duration" placeholder="Number of days" required />

        <label for="instruction">Instruction:</label>
        <input type="text" id="instruction" placeholder="Instruction" required />

        <!-- Button container for Cancel and Add buttons -->
        <div class="button-container">
            <button type="button" onclick="window.location.href='/';">Cancel</button>
            <button type="button" id="add-prescription">Add</button>
        </div>
    </form>
</div>
</body>
</html>
